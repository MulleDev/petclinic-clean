<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title th:text="#{petTypesManagement}">Pet Typen verwalten</title>
</head>
<body>
<div class="container">
    <h2 th:text="#{petTypesManagement}">Pet Typen verwalten</h2>
    <button class="btn btn-primary mb-3" data-pw="add-pet-type" onclick="document.getElementById('addPetTypeForm').style.display='block'" th:text="#{addPetType}">Neuen Pet Typ anlegen</button>
    <form id="addPetTypeForm" style="display:none" onsubmit="return addPetType(event)">
        <div class="mb-3">
            <label for="name" th:text="#{name}">Name</label>
            <input type="text" class="form-control" id="name" name="name" required>
        </div>
        <div class="mb-3">
            <label for="description" th:text="#{description}">Beschreibung</label>
            <input type="text" class="form-control" id="description" name="description">
        </div>
        <button type="submit" class="btn btn-success" data-pw="save-pet-type" th:text="#{save}">Speichern</button>
    </form>
    <table class="table table-striped" id="petTypesTable">
        <thead>
        <tr>
            <th th:text="#{name}">Name</th>
            <th th:text="#{description}">Beschreibung</th>
        </tr>
        </thead>
        <tbody id="petTypesTbody">
        <tr th:each="petType : ${petTypes}">
            <td th:text="${petType.name}">Typname</td>
            <td th:text="${petType.description}">Beschreibung</td>
        </tr>
        </tbody>
    </table>
    <script>
    async function addPetType(event) {
        event.preventDefault();
        const name = document.getElementById('name').value.trim();
        const description = document.getElementById('description').value.trim();
        if (!name) return;
        const res = await fetch('/api/pet-types', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ name, description })
        });
        if (res.ok) {
            const newType = await res.json();
            const tbody = document.getElementById('petTypesTbody');
            const tr = document.createElement('tr');
            tr.innerHTML = `<td>${newType.name}</td><td>${newType.description || ''}</td>`;
            tbody.appendChild(tr);
            document.getElementById('addPetTypeForm').reset();
            document.getElementById('addPetTypeForm').style.display = 'none';
        } else {
            alert('Fehler beim Anlegen!');
        }
        return false;
    }
    </script>
</div>
</body>
</html>
